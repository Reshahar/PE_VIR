PE病毒设计


API 地址的获取

打开入侵文件 修改PE结构

将自身写入程序

设置跳转


最终流程

获取API地址

打开可执行文件

判断病毒标志 （目标文件是否被感染）

如果被感染	则关闭文件 跳转到判断   IsHost
如果没被感染    则将病毒自身写入其中	然后跳转到　IsHost

首先CreateFile
再CreateFileMapping
最后MapViewOfFile

PE文件的知识

首先通过计算数据目录表的数量和节的数量计算到要插入文件的地址 

写入新添加节的名字
写入	节的实际大小
写入 	节的属性  可读 可写 可执行
通过对齐来计算  文件对齐和内存对齐值

在通过上一个节的信息计算出映射到内存的地址

同时计算在文件中的偏移

计算并修改映射到内存的映像大小

增加节的数量

然后写到节地址中
